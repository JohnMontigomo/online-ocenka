# Описание реализации
  - описание задания: http://montigomo.ru:8031/to-download/middle-dev-test-task.pdf
  - стенд с рабочей реализацией: http://montigomo.ru:8031

## Многослойная архитектура
  - возможно оверинжиниринг в данном случае, но закладывает основу для дальнейшего развития проекта, потребность в котором всегда возникает внезапно</p>

## Немного дополнительной вёрстки, меню и фичей
  - для придания минимальной законченности функционалу

## Асинхронное создание заказа
   - на предварительной беседе был вопрос про очереди

## Хранилище
  - mysql в контейнере; сущности: User, PriceList, Order; ORM - Doctrine</p>

## Тестирование
  - по причине асинхронности основного функционала немного усложнились тесты;
  конечно асинхронные приложения целесообразнее тестировать в полностью изолированной среде,
  но в данном случае ограничился разделением создания заказа на две очереди для test и dev окружения</p>

## Функционал

1. Чтобы войти - нужно зарегистрироваться, email можно ввести фейковый - верификация отсутствует
2. После успешной регистрации пользователь получает флэш-сообщение, перенаправляется на форму входа
3. Для создания заказа по дефолту используется email юзера для минимизации ошибок, email можно поменять
4. Поле выбора услуги всегда заполнено, поэтому оно не проверяется, проверятся только поле email
5. При некорректных данных на форме входа, регистрации, создания заказа пользователь получает сообщение об ошибке
6. При успешном создании заказа пользователь получает флэш-сообщение и может посмотреть свои заказы в списке заказов
7. Хранение атрибутов Order - title и price в дополнение к ссылке на PriceList сделано для того,
чтобы хранить существенные условия сделки с пользователем независимо от прайс-листа,
который гипотетически может измениться


## Разворачивание проекта на локальной машине

1. git clone https://github.com/JohnMontigomo/online-ocenka.git
2. cd online-ocenka (перейти в папку с клонированным проектом)
3. composer install (гипервизору нужна директория var, которую создаёт пакет Symfony)
4. chmod 777 var -R (для доступа к директрии гипервизора)
5. yarn install --ignore-engines (некоторые пакеты уже устарели)
6. yarn buid (собрать фронт-энд проекта)
7. docker-compose -f docker-compose.yml up -d  
   если уже пытались собрать раньше, лучше пересобрать: docker-compose -f docker-compose.yml up -d --build
8. На порту http://localhost:8031/ будет доступен web-интерфейс проекта
9. Если не заведётся - удалить все контейнеры с запустить снова, должно работать.  
10. В контейнере "php-online-ocenka" выполнить миграции: php bin/console doctrine:migrations:migrate --no-interaction
11. При необходимости создать тестовую базу и выполнить миграции, в контейнере "php-online-ocenka":
      php bin/console doctrine:database:create -n --env=test
      php bin/console doctrine:migrations:migrate -n --env=test
